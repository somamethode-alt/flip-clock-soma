<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>S≈çma Book - Dashboard Multi-Pages</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;1,400&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --cover-bg: #E1E3E3; 
            --page-bg: #ffffff; 
            --stat-lus-bg: #ffffff; 
            --stat-cours-bg: #ffffff; 
            --stat-pal-bg: #ffffff; 
        }

        /* --- FOND ET ASPECT TABLETTE --- */
        body { 
            font-family: 'Inter', sans-serif; margin: 0; background-color: #e8e8e8; 
            display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden;
        }

        .grain { position: fixed; inset: 0; pointer-events: none; z-index: 9999; opacity: 0.04; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"); }

        /* --- LE CARNET --- */
        #book-wrapper {
            width: 92vw; max-width: 1200px; height: 88vh;
            background: var(--page-bg); position: relative;
            box-shadow: 0 30px 60px rgba(0,0,0,0.2); border-radius: 4px;
            display: flex; z-index: 5;
        }

        /* --- COUVERTURE (PHOTO 1) --- */
        #cover { 
            position: absolute; inset: 0; background-color: var(--cover-bg); 
            background-size: cover; background-position: center; z-index: 1000; 
            display: flex; flex-direction: column; align-items: center; justify-content: space-between; 
            padding: 80px 20px; transition: transform 1s ease-in-out, opacity 0.8s ease;
            box-shadow: inset -2px 0 10px rgba(0,0,0,0.05); cursor: pointer;
        }
        #cover.opened { transform: translateX(-100%); opacity: 0; pointer-events: none; }

        /* --- ONGLETS (PHOTO 3 + TON CODE) --- */
        #tabs-container { 
            position: absolute; right: -45px; top: 40px; 
            display: flex; flex-direction: column; gap: 4px; z-index: 2; 
        }
        .tab { 
            width: 45px; height: 50px; border-radius: 0 8px 8px 0; 
            cursor: pointer; transition: 0.3s; box-shadow: 2px 2px 8px rgba(0,0,0,0.1); 
            display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold;
        }
        .tab:hover { width: 55px; }

        /* --- ZONE PAGES (PHOTO 2 + TON CODE) --- */
        #main-content { 
            flex: 1; position: relative; padding: 60px; overflow-y: auto; 
            opacity: 0; transition: opacity 0.5s;
        }
        .visible { opacity: 1 !important; }

        /* --- STYLES PAPIERS (TES 8 STYLES) --- */
        .paper-lined { background: repeating-linear-gradient(white 0px, white 26px, #e3e3e3 27px); }
        .paper-grid { background: linear-gradient(#eee 1px, transparent 1px), linear-gradient(90deg,#eee 1px, transparent 1px); background-size:25px 25px; }
        .paper-dots { background-image: radial-gradient(#bbb 1px, transparent 1px); background-size:20px 20px; }
        .paper-vintage { background:#f6f1e7; }
        .paper-architect { background: linear-gradient(#dde7f0 1px, transparent 1px), linear-gradient(90deg,#dde7f0 1px, transparent 1px); background-size:30px 30px; }
        .paper-blank { background:white; }
        .paper-planner { background:white; border-left:4px solid #ddd; }
        .paper-texture { background: linear-gradient(135deg,#fafafa 25%,transparent 25%) -10px 0/20px 20px, linear-gradient(225deg,#fafafa 25%,transparent 25%) -10px 0/20px 20px; }

        /* --- BARRE D'OUTILS --- */
        .toolbar { 
            position: absolute; top: 15px; right: 20px; 
            display: flex; gap: 15px; z-index: 100; background: rgba(255,255,255,0.8);
            padding: 8px 15px; border-radius: 30px; backdrop-filter: blur(5px);
        }
        .tool-btn { cursor: pointer; text-align: center; font-size: 9px; font-weight: bold; text-transform: uppercase; }

        /* --- CONTENU --- */
        .page-content { min-height: 100%; outline: none; font-size: 16px; line-height: 1.6; }

        /* --- MODALS --- */
        .modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 15px; z-index: 10001; width: 300px; box-shadow: 0 20px 50px rgba(0,0,0,0.2); }
        #overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.2); z-index: 10000; }
        .palette-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 10px; }
        .color-dot { width: 100%; aspect-ratio: 1; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body class="paper-lined">
    <div class="grain"></div>
    <div id="overlay" onclick="closeModals()"></div>

    <div id="book-wrapper">
        <div id="tabs-container"></div>

        <div id="cover" onclick="openBook()">
            <div style="font-family: 'Playfair Display', serif; font-size: 48px; letter-spacing: 4px; margin-top: 10vh;">S≈çma Book</div>
            <input type="text" id="userName" placeholder="NOM DE L'AUTEUR" style="border:none; border-bottom:1.5px solid #000; text-align: center; font-size: 14px; width: 280px; background: transparent; letter-spacing: 4px; text-transform: uppercase; outline:none;" onclick="event.stopPropagation()">
            <div style="font-size: 28px; letter-spacing: 12px; font-weight: 300;">S≈åMA</div>
        </div>

        <div id="main-content">
            <div class="toolbar">
                <div class="tool-btn" onclick="addPage()">‚ûï Page</div>
                <div class="tool-btn" onclick="openModal('paperModal')">üìÑ Papier</div>
                <div class="tool-btn" onclick="openModal('colorModal')">üé® Onglet</div>
                <div class="tool-btn" onclick="closeBook()">üìÅ Fermer</div>
            </div>

            <div id="editor" class="page-content" contenteditable="true">
                Clique ici pour commencer √† √©crire...
            </div>
        </div>
    </div>

    <div id="paperModal" class="modal">
        <p style="font-size: 10px; font-weight: bold; text-transform: uppercase;">Style de Papier</p>
        <select onchange="changePaper(this.value)" style="width:100%; padding:10px;">
            <option value="paper-lined">Lignes</option>
            <option value="paper-grid">Quadrillage</option>
            <option value="paper-dots">Pointill√©</option>
            <option value="paper-vintage">Cr√®me Vintage</option>
            <option value="paper-architect">Technique</option>
            <option value="paper-blank">Blanc</option>
            <option value="paper-planner">Planner</option>
            <option value="paper-texture">Texture</option>
        </select>
    </div>

    <div id="colorModal" class="modal">
        <p style="font-size: 10px; font-weight: bold; text-transform: uppercase;">Couleur de l'onglet</p>
        <div class="palette-grid" id="paletteGrid"></div>
    </div>

    <script>
        // TES 40 COULEURS
        const colors = ["#E1E3E3","#DFD8D5","#D8D5D2","#E6D4C4","#BAB1B0","#898684","#F2F8F8","#C3CED1","#B1A6A6","#B0AEB4","#A2A09A","#6F6869","#E8E7E7","#EEE9E9","#D5C7B3","#E2D7D4","#B0A19F","#C09D89","#D0CFCD","#E9F0F0","#E4DDD4","#B1B6AF","#D7D8D2","#B6AD9E","#DFE5E5","#E4E9EC","#B8BFBA","#8F877F","#859A9E","#BDD2E0","#F8FCFD","#E9EDEE","#CFCFD4","#E2DFD7","#E2D5D5","#DED0C7","#F6F2F0","#D4C1BA","#D0C9CB","#C1B2B1"];

        let tabsData = JSON.parse(localStorage.getItem('soma_tabs')) || [
            { color: "#E1E3E3", content: "Bienvenue dans votre Dashboard" },
            { color: "#DFD8D5", content: "Notes de lecture..." }
        ];
        let currentIdx = 0;

        function openBook() { 
            document.getElementById('cover').classList.add('opened'); 
            document.getElementById('main-content').classList.add('visible');
        }
        function closeBook() { 
            document.getElementById('cover').classList.remove('opened'); 
            document.getElementById('main-content').classList.remove('visible');
        }

        function openModal(id) { document.getElementById(id).style.display='block'; document.getElementById('overlay').style.display='block'; }
        function closeModals() { document.querySelectorAll('.modal').forEach(m=>m.style.display='none'); document.getElementById('overlay').style.display='none'; }

        // GESTION DES ONGLET (M√âLANGE DES DEUX CODES)
        function renderTabs() {
            const container = document.getElementById('tabs-container');
            container.innerHTML = "";
            tabsData.forEach((t, i) => {
                const el = document.createElement("div");
                el.className = "tab";
                el.style.background = t.color;
                el.textContent = i + 1;
                el.onclick = () => selectTab(i);
                container.appendChild(el);
            });
        }

        function selectTab(i) {
            // Sauvegarder le contenu actuel avant de changer
            tabsData[currentIdx].content = document.getElementById('editor').innerHTML;
            currentIdx = i;
            document.getElementById('editor').innerHTML = tabsData[currentIdx].content;
            renderTabs();
        }

        function addPage() {
            tabsData.push({ color: colors[Math.floor(Math.random()*colors.length)], content: "Nouvelle page..." });
            renderTabs();
            selectTab(tabsData.length - 1);
        }

        function changePaper(style) {
            document.getElementById('main-content').className = style + " visible";
            localStorage.setItem('soma_paper', style);
            closeModals();
        }

        // Palette des 40 couleurs
        const grid = document.getElementById('paletteGrid');
        colors.forEach(c => {
            const d = document.createElement('div');
            d.className = 'color-dot'; d.style.background = c;
            d.onclick = () => {
                tabsData[currentIdx].color = c;
                renderTabs();
                closeModals();
                save();
            };
            grid.appendChild(d);
        });

        function save() {
            tabsData[currentIdx].content = document.getElementById('editor').innerHTML;
            localStorage.setItem('soma_tabs', JSON.stringify(tabsData));
        }

        document.getElementById('editor').oninput = save;

        // Init
        window.onload = () => {
            renderTabs();
            const savedPaper = localStorage.getItem('soma_paper');
            if(savedPaper) changePaper(savedPaper);
            document.getElementById('editor').innerHTML = tabsData[0].content;
        };
    </script>
</body>
</html>
